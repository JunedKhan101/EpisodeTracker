{% extends 'index.html' %}
{% load static %}
{% block title %} <title>Edit Series</title> {% endblock %}
{% block style %}
<link rel="stylesheet" href="{% static 'css/seriespage.css' %}">
{% endblock %}

{% block content %}
{% with series_slug=series.slug %} 
  <div id="ImageCover-container">
    {% if series.CoverImage.name == '/noimg.png' %}
      <h1 id="CoverImage-SeriesName" style="color: black;">{{series.SeriesName}}</h1>
    {% else %}
      <img id="CoverImage" src="{{series.CoverImage.url}}" alt="Image">
      <h1 id="CoverImage-SeriesName">{{series.SeriesName}}</h1>
    {% endif %}
  </div>
  <hr class="bottom-border">

  <button class="btn btn-primary" id="add-season-button" data-toggle="modal" data-target="#seriesmodal">Add a season</button>

  <!-- Modal -->
  <div class="modal fade" id="seriesmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Add season</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form method="POST" id="SeasonsForm"> {% csrf_token %}
            {% for field in form %}
            {{ field.label_tag }} {{ field }}<br>
            {% endfor %}
            <strong id="errormsg" style="color: red;">
           </strong>
         </form>
       </div>
       <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary" form="SeasonsForm">Add</button>
      </div>
    </div>
  </div>
  </div>

    <div id="season-container">
  	{% for season in seasons %}
    <a href="{% url 'seasonspage' series.slug season.slug %}">
    	<div id="season">
    		<p id="season-name">{{season.SeasonName}}</p>
    	</div>
    </a>
  	{% endfor %}
  </div>
  {% endwith %}
<script>
  `{% if form.non_field_errors %}`
    $("#errormsg").html( `{{ form.non_field_errors|striptags }}` );
    $("#seriesmodal").modal('show');
  `{% endif %}`

  {% if messages %}
  {% for msg in messages %}
    $("#errormsg").html( `{{ msg }}` );
  {% endfor %}
    $("#seriesmodal").modal('show');
  {% endif %}
</script>
<br /><br /><br /><br /><br /><br /><br /><br /><br />
{% endblock %}